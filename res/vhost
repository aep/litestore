<VirtualHost *:80>

    DocumentRoot "/home/<<RSTI_UNIXUSER>>/html/restore/app"

    ServerName <<RSTI_DOMAIN>>
    ServerAlias www.<<RSTI_DOMAIN>>



    RewriteEngine on

    RewriteRule  ^/admin/export/(.*)\.csv$            /admin/export.php?format=csv&scheme=$1 [PT]
    RewriteRule  ^/admin/export/(.*)\.xml$            /admin/export.php?format=xml&scheme=$1 [PT]

    Alias /templates        /home/<<RSTI_UNIXUSER>>/html/restore/templates
    Alias /images           /home/<<RSTI_UNIXUSER>>/html/restore/images
    Alias /admin/images     /home/<<RSTI_UNIXUSER>>/html/restore/admin/images
    Alias /admin            /home/<<RSTI_UNIXUSER>>/html/restore/admin
    Alias /javascript       /home/<<RSTI_UNIXUSER>>/html/restore/app/includes/javascript
    Alias /media            /home/<<RSTI_UNIXUSER>>/html/restore/app/media



    RewriteCond  %{REQUEST_URI} !^/(admin|templates|images|javascript|media)/.*$
    RewriteRule  ^(.*)$    /index.php?path=$1&%{QUERY_STRING}


    #allow the aliased access
    <Directory /home/<<RSTI_UNIXUSER>>/html/ >
            AllowOverride None
            Options Indexes
            Order Allow,Deny
            Allow from all
    </Directory>


    #enable php execution in the app directory

    <Directory /home/<<RSTI_UNIXUSER>>/html/restore/app/ >
        DirectoryIndex index.php index.html
        AddHandler application/x-httpd-php .php
    </Directory>
    <Directory /home/<<RSTI_UNIXUSER>>/html/restore/admin >
        DirectoryIndex index.php index.html
        AddHandler application/x-httpd-php .php
    </Directory>


    #disable execution for and deny access to subdirectories

    <Directory /home/<<RSTI_UNIXUSER>>/html/restore/app/* >
        DirectoryIndex index.html
        RemoveHandler .php
        Order Deny,Allow
        Deny from all
    </Directory>
    <Directory /home/<<RSTI_UNIXUSER>>/html/restore/admin/* >
        DirectoryIndex index.html
        RemoveHandler .php
        Order Deny,Allow
        Deny from all
    </Directory>
    <Directory /home/<<RSTI_UNIXUSER>>/html/restore/admin/images/ >
        Order Allow,Deny
        Allow from all
    </Directory>
    <Directory  /home/<<RSTI_UNIXUSER>>/html/restore/admin/includes/fm >
        Order Allow,Deny
        Allow from all
    </Directory>
    <Directory  /home/<<RSTI_UNIXUSER>>/html/restore/media >
        Order Allow,Deny
        Allow from all
    </Directory>


    #javascript
    <Directory /home/<<RSTI_UNIXUSER>>/html/restore/app/includes/javascript/ >
        Order Allow,Deny
        Allow from all
    </Directory>

</VirtualHost>
